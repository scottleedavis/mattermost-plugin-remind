package main

import (
	"time"

	"github.com/mattermost/mattermost-server/model"
	"github.com/nicksnyder/go-i18n/i18n"
)

func (p *Plugin) translation(user *model.User) (i18n.TranslateFunc, string) {
	locale := "en"
	for _, l := range p.supportedLocales {
		if user.Locale == l {
			locale = user.Locale
			break
		}
	}
	return GetUserTranslations(locale), locale
}

func (p *Plugin) location(user *model.User) *time.Location {
	timezone := user.GetPreferredTimezone()
	if timezone == "" {
		timezone, _ = time.Now().Zone()
	}
	return time.FixedZone(timezone, UTCOffsets[timezone])
}

var UTCOffsets = map[string]int{
	"GMT+12": -43200,
	"GMT+11": -39600,
	"NUT":    -39600,
	"SST":    -39600,
	"CKT":    -36000,
	"GMT+10": -36000,
	"HST":    -36000,
	"TAHT":   -36000,
	"MART":   -34200,
	"AKST":   -32400,
	"GAMT":   -32400,
	"GMT+9":  -32400,
	"GMT+8":  -28800,
	"PST":    -28800,
	"PDT":    -25200,
	"GMT+7":  -25200,
	"MST":    -25200,
	"CST":    -21600,
	"GALT":   -21600,
	"GMT+6":  -21600,
	"ACT":    -18000,
	"COT":    -18000,
	"EAST":   -18000,
	"ECT":    -18000,
	"EST":    -18000,
	"GMT+5":  -18000,
	"PET":    -18000,
	"VET":    -16200,
	"AMT":    -14400,
	"AST":    -14400,
	"BOT":    -14400,
	"GMT+4":  -14400,
	"GYT":    -14400,
	"NST":    -12600,
	"ART":    -10800,
	"BRT":    -10800,
	"CLT":    -10800,
	"FKST":   -10800,
	"GFT":    -10800,
	"GMT+3":  -10800,
	"PMST":   -10800,
	"PYST":   -10800,
	"ROTT":   -10800,
	"SRT":    -10800,
	"WGT":    -10800,
	"FNT":    -7200,
	"GMT+2":  -7200,
	"UYST":   -7200,
	"AZOT":   -3600,
	"CVT":    -3600,
	"EGT":    -3600,
	"GMT+1":  -3600,
	"GMT":    0,
	"UCT":    0,
	"UTC":    0,
	"WET":    0,
	"CET":    3600,
	"GMT-1":  3600,
	"MET":    3600,
	"WAT":    3600,
	"CAT":    7200,
	"EET":    7200,
	"GMT-2":  7200,
	"SAST":   7200,
	"WAST":   7200,
	"EAT":    10800,
	"GMT-3":  10800,
	"MSK":    10800,
	"SYOT":   10800,
	"IRST":   12600,
	"AZT":    14400,
	"GET":    14400,
	"GMT-4":  14400,
	"GST":    14400,
	"MUT":    14400,
	"RET":    14400,
	"SAMT":   14400,
	"SCT":    14400,
	"AFT":    16200,
	"AQTT":   18000,
	"GMT-5":  18000,
	"MAWT":   18000,
	"MVT":    18000,
	"ORAT":   18000,
	"PKT":    18000,
	"TFT":    18000,
	"TJT":    18000,
	"TMT":    18000,
	"UZT":    18000,
	"YEKT":   18000,
	"IST":    19800,
	"NPT":    20700,
	"ALMT":   21600,
	"BDT":    21600,
	"BTT":    21600,
	"GMT-6":  21600,
	"IOT":    21600,
	"KGT":    21600,
	"NOVT":   21600,
	"OMST":   21600,
	"QYZT":   21600,
	"VOST":   21600,
	"XJT":    21600,
	"CCT":    23400,
	"MMT":    23400,
	"CXT":    25200,
	"DAVT":   25200,
	"GMT-7":  25200,
	"HOVT":   25200,
	"ICT":    25200,
	"KRAT":   25200,
	"WIB":    25200,
	"AWST":   28800,
	"BNT":    28800,
	"CHOT":   28800,
	"GMT-8":  28800,
	"HKT":    28800,
	"IRKT":   28800,
	"MYT":    28800,
	"PHT":    28800,
	"SGT":    28800,
	"ULAT":   28800,
	"WITA":   28800,
	"ACWST":  31500,
	"GMT-9":  32400,
	"JST":    32400,
	"KST":    32400,
	"PWT":    32400,
	"TLT":    32400,
	"WIT":    32400,
	"YAKT":   32400,
	"ACST":   34200,
	"AEST":   36000,
	"CHUT":   36000,
	"ChST":   36000,
	"DDUT":   36000,
	"GMT-10": 36000,
	"MAGT":   36000,
	"PGT":    36000,
	"SAKT":   36000,
	"VLAT":   36000,
	"ACDT":   37800,
	"AEDT":   39600,
	"BST":    39600,
	"GMT-11": 39600,
	"KOST":   39600,
	"LHDT":   39600,
	"MIST":   39600,
	"NCT":    39600,
	"PONT":   39600,
	"SBT":    39600,
	"SRET":   39600,
	"VUT":    39600,
	"NFT":    41400,
	"ANAT":   43200,
	"FJT":    43200,
	"GILT":   43200,
	"GMT-12": 43200,
	"MHT":    43200,
	"NRT":    43200,
	"PETT":   43200,
	"TVT":    43200,
	"WAKT":   43200,
	"WFT":    43200,
	"GMT-13": 46800,
	"NZDT":   46800,
	"PHOT":   46800,
	"TKT":    46800,
	"TOT":    46800,
	"CHADT":  49500,
	"GMT-14": 50400,
	"LINT":   50400,
	"WSDT":   50400,
}
